<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>xml-expat-lite.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.18 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="globals.html">Globals</a> &nbsp; </center>
<hr><h1>xml-expat-lite.c</h1><a href="xml-expat-lite_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="preprocessor">#include &lt;<a class="code" href="rossnet_8h.html">rossnet.h</a>&gt;</span>
00002 
<a name="l00003"></a><a class="code" href="xml-expat-lite_8c.html#a0">00003</a> <span class="preprocessor">#define XML_BUFFER_SZ 1024</span>
00004 <span class="preprocessor"></span>
<a name="l00005"></a><a class="code" href="xml-expat-lite_8c.html#a1">00005</a> rn_link         *<a class="code" href="xml-expat-lite_8c.html#a1">l</a>;
00006 
<a name="l00007"></a><a class="code" href="xml-expat-lite_8c.html#a2">00007</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>     <a class="code" href="xml-expat-lite_8c.html#a2">next_link</a> = 0;
<a name="l00008"></a><a class="code" href="xml-expat-lite_8c.html#a3">00008</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>     <a class="code" href="xml-expat-lite_8c.html#a3">next_machine</a> = 0;
<a name="l00009"></a><a class="code" href="xml-expat-lite_8c.html#a4">00009</a> rn_machine      *<a class="code" href="xml-expat-lite_8c.html#a4">m</a> = NULL;
00010 
<a name="l00011"></a><a class="code" href="xml-expat-lite_8c.html#a5">00011</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>     <a class="code" href="xml-expat-lite_8c.html#a5">next_sn</a> = 0;
<a name="l00012"></a><a class="code" href="xml-expat-lite_8c.html#a6">00012</a> rn_subnet       *<a class="code" href="xml-expat-lite_8c.html#a6">sn</a> = NULL;
00013 
<a name="l00014"></a><a class="code" href="xml-expat-lite_8c.html#a7">00014</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>     <a class="code" href="xml-expat-lite_8c.html#a7">next_ar</a> = 0;
<a name="l00015"></a><a class="code" href="xml-expat-lite_8c.html#a8">00015</a> rn_area         *<a class="code" href="xml-expat-lite_8c.html#a8">ar</a> = NULL;
00016 
<a name="l00017"></a><a class="code" href="xml-expat-lite_8c.html#a9">00017</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>     <a class="code" href="xml-expat-lite_8c.html#a9">next_as</a> = 0;
<a name="l00018"></a><a class="code" href="xml-expat-lite_8c.html#a10">00018</a> rn_as           *<a class="code" href="xml-expat-lite_8c.html#a10">as</a> = NULL;
00019 
00020 <span class="keywordtype">void</span>
<a name="l00021"></a><a class="code" href="xml-expat-lite_8c.html#a11">00021</a> <a class="code" href="xml-expat-lite_8c.html#a11">start_element</a>(<span class="keywordtype">void</span> * user_data, <span class="keyword">const</span> <span class="keywordtype">char</span> * name, <span class="keyword">const</span> <span class="keywordtype">char</span> ** atts)
00022 {
00023         <span class="keywordtype">int</span>    *depth_p = user_data;
00024         <span class="keywordtype">int</span>     i = 0;
00025 
00026         <span class="keywordflow">if</span>(0 == strcmp(<span class="stringliteral">"as"</span>, name))
00027         {
00028                 g_rn_nas++;
00029                 <a class="code" href="xml-expat-lite_8c.html#a10">as</a> = (rn_as *) calloc(<span class="keyword">sizeof</span>(rn_as), 1);
00030 
00031                 <span class="keywordflow">if</span>(!<a class="code" href="xml-expat-lite_8c.html#a10">as</a>)
00032                         tw_error(TW_LOC, <span class="stringliteral">"Unable to alloc memory for as %d"</span>,
00033                                                 g_rn_nas);
00034 
00035                 <a class="code" href="xml-expat-lite_8c.html#a10">as</a>-&gt;next = g_rn_as;
00036 
00037                 <span class="keywordflow">if</span>(g_rn_as)
00038                         g_rn_as-&gt;next = <a class="code" href="xml-expat-lite_8c.html#a10">as</a>;
00039                 <span class="keywordflow">else</span>
00040                         g_rn_as = <a class="code" href="xml-expat-lite_8c.html#a10">as</a>;
00041 
00042                 <span class="keywordflow">while</span>(atts[i] != NULL)
00043                 {
00044                         <span class="keywordflow">if</span>(0 == strcmp(<span class="stringliteral">"id"</span>, atts[i]))
00045                         {
00046                                 <a class="code" href="xml-expat-lite_8c.html#a10">as</a>-&gt;id = atoi(atts[i+1]);
00047                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(0 == strcmp(<span class="stringliteral">"frequency"</span>, atts[i]))
00048                         {
00049                                 <a class="code" href="xml-expat-lite_8c.html#a10">as</a>-&gt;frequency = atoi(atts[i+1]);
00050                         } <span class="keywordflow">else</span>
00051                                 tw_error(TW_LOC, <span class="stringliteral">"Unknown as attr: %s = %s"</span>,
00052                                                 atts[i], atts[i+1]);
00053         
00054                         i += 2;
00055                 }
00056 
00057         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(0 == strcmp(<span class="stringliteral">"area"</span>, name))
00058         {
00059                 <a class="code" href="xml-expat-lite_8c.html#a10">as</a>-&gt;nareas++;
00060                 <a class="code" href="xml-expat-lite_8c.html#a8">ar</a> = (rn_area *) calloc(<span class="keyword">sizeof</span>(rn_area), 1);
00061 
00062                 <span class="keywordflow">if</span>(!<a class="code" href="xml-expat-lite_8c.html#a8">ar</a>)
00063                         tw_error(TW_LOC, <span class="stringliteral">"Unable to alloc mem for area %d in as %d"</span>,
00064                                                 <a class="code" href="xml-expat-lite_8c.html#a10">as</a>-&gt;id, <a class="code" href="xml-expat-lite_8c.html#a10">as</a>-&gt;nareas);
00065 
00066                 <a class="code" href="xml-expat-lite_8c.html#a8">ar</a>-&gt;next = <a class="code" href="xml-expat-lite_8c.html#a10">as</a>-&gt;areas;
00067                 <a class="code" href="xml-expat-lite_8c.html#a10">as</a>-&gt;areas = <a class="code" href="xml-expat-lite_8c.html#a8">ar</a>;
00068 
00069                 <a class="code" href="xml-expat-lite_8c.html#a8">ar</a>-&gt;as = <a class="code" href="xml-expat-lite_8c.html#a10">as</a>;
00070 
00071                 <span class="keywordflow">while</span>(atts[i] != NULL)
00072                 {
00073                         <span class="keywordflow">if</span>(0 == strcmp(<span class="stringliteral">"id"</span>, atts[i]))
00074                         {
00075                                 <a class="code" href="xml-expat-lite_8c.html#a8">ar</a>-&gt;id = atoi(atts[i+1]);
00076                         } <span class="keywordflow">else</span>
00077                                 tw_error(TW_LOC, <span class="stringliteral">"Unknown area attr: %s = %s"</span>,
00078                                                 atts[i], atts[i+1]);
00079 
00080                         i += 2;
00081                 }       
00082         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(0 == strcmp(<span class="stringliteral">"subnet"</span>, name))
00083         {
00084                 <a class="code" href="xml-expat-lite_8c.html#a8">ar</a>-&gt;nsubnets++;
00085                 <a class="code" href="xml-expat-lite_8c.html#a6">sn</a> = (rn_subnet *) calloc(<span class="keyword">sizeof</span>(rn_subnet), 1);
00086 
00087                 <span class="keywordflow">if</span>(!<a class="code" href="xml-expat-lite_8c.html#a6">sn</a>)
00088                         tw_error(TW_LOC, <span class="stringliteral">"Unable to alloc mem for subnet %d in area %d in as %d"</span>,
00089                                         <a class="code" href="xml-expat-lite_8c.html#a8">ar</a>-&gt;nsubnets, <a class="code" href="xml-expat-lite_8c.html#a8">ar</a>-&gt;id, <a class="code" href="xml-expat-lite_8c.html#a10">as</a>-&gt;id);
00090 
00091                 <a class="code" href="xml-expat-lite_8c.html#a6">sn</a>-&gt;next = <a class="code" href="xml-expat-lite_8c.html#a8">ar</a>-&gt;subnets;
00092                 <a class="code" href="xml-expat-lite_8c.html#a8">ar</a>-&gt;subnets = <a class="code" href="xml-expat-lite_8c.html#a6">sn</a>;
00093 
00094                 <a class="code" href="xml-expat-lite_8c.html#a6">sn</a>-&gt;area = <a class="code" href="xml-expat-lite_8c.html#a8">ar</a>;
00095 
00096                 <span class="keywordflow">while</span>(atts[i] != NULL)
00097                 {
00098                         <span class="keywordflow">if</span>(0 == strcmp(<span class="stringliteral">"id"</span>, atts[i]))
00099                         {
00100                                 <a class="code" href="xml-expat-lite_8c.html#a6">sn</a>-&gt;id = atoi(atts[i+1]);
00101                         } <span class="keywordflow">else</span>
00102                                 tw_error(TW_LOC, <span class="stringliteral">"Unknown subnet attr: %s = %s"</span>,
00103                                                 atts[i], atts[i+1]);
00104 
00105                         i += 2;
00106                 }       
00107         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(0 == strcmp(<span class="stringliteral">"machine"</span>, name))
00108         {
00109                 g_rn_nmachines++;
00110                 g_tw_nlp++;
00111 
00112                 <a class="code" href="xml-expat-lite_8c.html#a4">m</a> = (rn_machine *) calloc(<span class="keyword">sizeof</span>(rn_machine), 1);
00113 
00114                 <span class="keywordflow">if</span>(!<a class="code" href="xml-expat-lite_8c.html#a4">m</a>)
00115                         tw_error(TW_LOC, <span class="stringliteral">"Unable to alloc mem for machine in sn %d"</span>,
00116                                         <a class="code" href="xml-expat-lite_8c.html#a6">sn</a>-&gt;id);
00117 
00118                 <a class="code" href="xml-expat-lite_8c.html#a4">m</a>-&gt;nlayers = 0;
00119                 <a class="code" href="xml-expat-lite_8c.html#a4">m</a>-&gt;sn = <a class="code" href="xml-expat-lite_8c.html#a6">sn</a>;
00120 
00121                 <span class="keywordflow">while</span>(atts[i] != NULL)
00122                 {
00123                         <span class="keywordflow">if</span>(0 == strcmp(<span class="stringliteral">"type"</span>, atts[i]))
00124                         {
00125                                 <span class="keywordflow">if</span>(0 == strcmp(<span class="stringliteral">"endpoint"</span>, atts[i+1]))
00126                                 {
00127                                         <a class="code" href="xml-expat-lite_8c.html#a6">sn</a>-&gt;nhosts++;
00128                                         <a class="code" href="xml-expat-lite_8c.html#a4">m</a>-&gt;type = ENDPOINT;
00129                                         <a class="code" href="xml-expat-lite_8c.html#a4">m</a>-&gt;next = <a class="code" href="xml-expat-lite_8c.html#a6">sn</a>-&gt;hosts;
00130                                         <a class="code" href="xml-expat-lite_8c.html#a6">sn</a>-&gt;hosts = <a class="code" href="xml-expat-lite_8c.html#a4">m</a>;
00131                                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(0 == strcmp(<span class="stringliteral">"router"</span>, atts[i+1]))
00132                                 {
00133                                         <a class="code" href="xml-expat-lite_8c.html#a8">ar</a>-&gt;nrouters++;
00134                                         <a class="code" href="xml-expat-lite_8c.html#a6">sn</a>-&gt;nrouters++;
00135                                         <a class="code" href="xml-expat-lite_8c.html#a4">m</a>-&gt;type = ROUTER;
00136                                         <a class="code" href="xml-expat-lite_8c.html#a4">m</a>-&gt;next = <a class="code" href="xml-expat-lite_8c.html#a6">sn</a>-&gt;routers;
00137                                         <a class="code" href="xml-expat-lite_8c.html#a6">sn</a>-&gt;routers = <a class="code" href="xml-expat-lite_8c.html#a4">m</a>;
00138                                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(0 == strcmp(<span class="stringliteral">"gateway"</span>, atts[i+1]))
00139                                 {
00140                                         <a class="code" href="xml-expat-lite_8c.html#a8">ar</a>-&gt;ngateways++;
00141                                         <a class="code" href="xml-expat-lite_8c.html#a4">m</a>-&gt;type = GATEWAY;
00142                                         <a class="code" href="xml-expat-lite_8c.html#a4">m</a>-&gt;next = <a class="code" href="xml-expat-lite_8c.html#a8">ar</a>-&gt;gateways;
00143                                         <a class="code" href="xml-expat-lite_8c.html#a8">ar</a>-&gt;gateways = <a class="code" href="xml-expat-lite_8c.html#a4">m</a>;
00144                                 } <span class="keywordflow">else</span>
00145                                         tw_error(TW_LOC, <span class="stringliteral">"Unknown machine type: %s"</span>,
00146                                                 atts[i+1]);
00147                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(0 == strcmp(<span class="stringliteral">"id"</span>, atts[i]))
00148                         {
00149                                 <a class="code" href="xml-expat-lite_8c.html#a4">m</a>-&gt;id = atoi(atts[i+1]);
00150                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(0 == strcmp(<span class="stringliteral">"links"</span>, atts[i]))
00151                         {
00152                                 <a class="code" href="xml-expat-lite_8c.html#a4">m</a>-&gt;nlinks = atoi(atts[i+1]);
00153 
00154                                 <a class="code" href="xml-expat-lite_8c.html#a4">m</a>-&gt;link = (rn_link *) calloc(<span class="keyword">sizeof</span>(rn_link) *
00155                                                         <a class="code" href="xml-expat-lite_8c.html#a4">m</a>-&gt;nlinks, 1);
00156 
00157                         } <span class="keywordflow">else</span>
00158                                 tw_error(TW_LOC, <span class="stringliteral">"Unknown machine attr: %s = %s"</span>, 
00159                                                 atts[i], atts[i+1]);
00160 
00161                         i += 2;
00162                 }
00163 
00164         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(0 == strcmp(<span class="stringliteral">"link"</span>, name))
00165         {
00166                 <span class="keywordflow">while</span>(atts[i] != NULL)
00167                 {
00168                         <span class="keywordflow">if</span>(0 == strcmp(<span class="stringliteral">"speed"</span>, atts[i]))
00169                         {
00170                                 <a class="code" href="xml-expat-lite_8c.html#a4">m</a>-&gt;link[<a class="code" href="xml-expat-lite_8c.html#a2">next_link</a>].speed = atol(atts[i+1]);
00171                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(0 == strcmp(<span class="stringliteral">"status"</span>, atts[i]))
00172                         {
00173                                 <span class="keywordflow">if</span>(0 == strcmp(<span class="stringliteral">"up"</span>, atts[i+1]))
00174                                         <a class="code" href="xml-expat-lite_8c.html#a4">m</a>-&gt;link[<a class="code" href="xml-expat-lite_8c.html#a2">next_link</a>].status = 1;
00175                                 <span class="keywordflow">else</span>
00176                                         <a class="code" href="xml-expat-lite_8c.html#a4">m</a>-&gt;link[<a class="code" href="xml-expat-lite_8c.html#a2">next_link</a>].status = 0;
00177                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(0 == strcmp(<span class="stringliteral">"addr"</span>, atts[i]))
00178                         {
00179                                 <a class="code" href="xml-expat-lite_8c.html#a4">m</a>-&gt;link[<a class="code" href="xml-expat-lite_8c.html#a2">next_link</a>].addr = atol(atts[i+1]);
00180                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(0 == strcmp(<span class="stringliteral">"bandwidth"</span>, atts[i]))
00181                         {
00182                                 <a class="code" href="xml-expat-lite_8c.html#a4">m</a>-&gt;link[<a class="code" href="xml-expat-lite_8c.html#a2">next_link</a>].bandwidth = atoi(atts[i+1]);
00183                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(0 == strcmp(<span class="stringliteral">"cost"</span>, atts[i]))
00184                         {
00185                                 <a class="code" href="xml-expat-lite_8c.html#a4">m</a>-&gt;link[<a class="code" href="xml-expat-lite_8c.html#a2">next_link</a>].cost = atoi(atts[i+1]);
00186                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(0 == strcmp(<span class="stringliteral">"delay"</span>, atts[i]))
00187                         {
00188                                 <a class="code" href="xml-expat-lite_8c.html#a4">m</a>-&gt;link[<a class="code" href="xml-expat-lite_8c.html#a2">next_link</a>].delay = atof(atts[i+1]);
00189                         } <span class="keywordflow">else</span>
00190                                 tw_error(TW_LOC, <span class="stringliteral">"Unknown link attr: %s"</span>, atts[i+1]);
00191 
00192                         i += 2;
00193                 }
00194 
00195                 <a class="code" href="xml-expat-lite_8c.html#a2">next_link</a>++;
00196         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(0 == strcmp(<span class="stringliteral">"application"</span>, name))
00197         {
00198                 <a class="code" href="xml-expat-lite_8c.html#a4">m</a>-&gt;nlayers++;
00199 
00200                 <span class="keywordflow">while</span>(atts[i] != NULL)
00201                 {
00202                         <span class="keywordflow">if</span>(0 == strcmp(<span class="stringliteral">"name"</span>, atts[i]))
00203                         {
00204                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(0 == strcmp(<span class="stringliteral">"file_size"</span>, atts[i]))
00205                         {
00206                                 tw_error(TW_LOC, <span class="stringliteral">"RN trying to get FTP element!"</span>);
00207                                 <span class="comment">//g_ftp_buffer_size = atol(atts[i+1]);</span>
00208                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(0 == strcmp(<span class="stringliteral">"chunk"</span>, atts[i]))
00209                         {
00210                                 tw_error(TW_LOC, <span class="stringliteral">"RN trying to get FTP element!"</span>);
00211                                 <span class="comment">//g_ftp_chunk_size = atol(atts[i+1]);</span>
00212                         } <span class="keywordflow">else</span>
00213                                 tw_error(TW_LOC, <span class="stringliteral">"Unknown application attr: %s"</span>, 
00214                                                         atts[i]);
00215 
00216                         i += 2;
00217                 }
00218         } <span class="keywordflow">else</span>
00219         {
00220                 tw_lptype       *t;
00221 
00222                 printf(<span class="stringliteral">"Unknown XML element: %s \n"</span>, name);
00223 
00224                 <span class="keywordflow">for</span>(t = g_rn_lptypes; t &amp;&amp; t-&gt;name; t++)
00225                 {
00226                         printf(<span class="stringliteral">"Testing %d \n"</span>, t-&gt;name);
00227                 }
00228         }
00229 
00230         *depth_p += 1;
00231 }
00232 
00233 <span class="keywordtype">void</span>
<a name="l00234"></a><a class="code" href="xml-expat-lite_8c.html#a12">00234</a> <a class="code" href="xml-expat-lite_8c.html#a12">end_element</a>(<span class="keywordtype">void</span> * user_data, <span class="keyword">const</span> <span class="keywordtype">char</span> * name)
00235 {
00236         <span class="keywordtype">int</span>     *depth_p = user_data;
00237         
00238         *depth_p -= 2;
00239 
00240         <span class="keywordflow">if</span>(0 == strcmp(<span class="stringliteral">"machine"</span>, name))
00241                 <a class="code" href="xml-expat-lite_8c.html#a2">next_link</a> = 0;
00242 }
00243 
00244 <span class="keywordtype">void</span>
<a name="l00245"></a><a class="code" href="xml-expat-lite_8c.html#a13">00245</a> <a class="code" href="xml-expat-lite_8c.html#a13">rn_read_xml_config</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)
00246 {
00247         FILE    *config;
00248         <span class="keywordtype">char</span>    *cfg;
00249         <span class="keywordtype">int</span>      c;
00250         <span class="keywordtype">int</span>      done;
00251         <span class="keywordtype">int</span>      depth;
00252         <span class="keywordtype">int</span>      len;
00253 
00254         <span class="keywordtype">char</span>     buffer[<a class="code" href="xml-expat-lite_8c.html#a0">XML_BUFFER_SZ</a>];
00255 
00256         XML_Parser      parser;
00257 
00258         parser = XML_ParserCreate(NULL);
00259         XML_SetUserData(parser, &amp;depth);
00260         XML_SetElementHandler(parser, <a class="code" href="xml-expat-lite_8c.html#a11">start_element</a>, <a class="code" href="xml-expat-lite_8c.html#a12">end_element</a>);
00261 
00262         <span class="comment">/*</span>
00263 <span class="comment">         * Default var assignments</span>
00264 <span class="comment">         */</span>
00265         g_tw_ts_end = 100000;
00266         cfg = <span class="stringliteral">"config/machines.xml"</span>;
00267 
00268         printf(<span class="stringliteral">"\n"</span>);
00269         <span class="keywordflow">while</span>(-1 != (c = getopt(argc, argv, <span class="stringliteral">"c:t:"</span>)))
00270         {
00271                 <span class="keywordflow">switch</span>(c)
00272                 {
00273                         <span class="keywordflow">case</span> <span class="charliteral">'c'</span>:
00274                                 cfg = optarg;
00275                                 printf(<span class="stringliteral">"Opening config file: %s \n"</span>, cfg);
00276                                 <span class="keywordflow">break</span>;
00277                         <span class="keywordflow">case</span> <span class="charliteral">'t'</span>:
00278                                 g_tw_ts_end = atoi(optarg);
00279                                 printf(<span class="stringliteral">"Setting end time: %15.2f \n"</span>, g_tw_ts_end);
00280                                 <span class="keywordflow">break</span>;
00281                 }
00282         }
00283         printf(<span class="stringliteral">"\n"</span>);
00284 
00285         <span class="keywordflow">if</span> ((config = fopen(cfg, <span class="stringliteral">"r"</span>)) == 0)
00286                 tw_error(TW_LOC, <span class="stringliteral">"Unable to open config file: %s\n"</span>, cfg);
00287 
00288         done = 0;
00289         <span class="keywordflow">while</span>(!done)
00290         {
00291                 len = fread(buffer, 1, <a class="code" href="xml-expat-lite_8c.html#a0">XML_BUFFER_SZ</a>, config);
00292                 done = feof(config);
00293 
00294                 <span class="keywordflow">if</span>(!XML_Parse(parser, buffer, len, done))
00295                 {
00296                         tw_error(TW_LOC, <span class="stringliteral">"expat: %s at line %d \n"</span>,
00297                                 XML_ErrorString(XML_GetErrorCode(parser)),
00298                                 XML_GetCurrentLineNumber(parser));
00299                 }
00300         }
00301 
00302         XML_ParserFree(parser);
00303 
00304         g_rn_machines = (rn_machine **) calloc(<span class="keyword">sizeof</span>(rn_machine *) * g_rn_nmachines, 1);
00305 
00306         <span class="keywordflow">if</span>(!g_rn_machines)
00307                 tw_error(TW_LOC, <span class="stringliteral">"Unable to allocate machine array!"</span>);
00308 
00309         <span class="keywordflow">for</span> (<a class="code" href="xml-expat-lite_8c.html#a10">as</a> = NULL; NULL != (<a class="code" href="xml-expat-lite_8c.html#a10">as</a> = <a class="code" href="rn-as_8c.html#a0">rn_nextas</a>(<a class="code" href="xml-expat-lite_8c.html#a10">as</a>));)
00310         {
00311                 printf(<span class="stringliteral">"AS: %d \n"</span>, <a class="code" href="xml-expat-lite_8c.html#a10">as</a>-&gt;id);
00312                 printf(<span class="stringliteral">"nBorders: %d \n"</span>, <a class="code" href="xml-expat-lite_8c.html#a10">as</a>-&gt;nborders);
00313                 printf(<span class="stringliteral">"nAreas: %d \n"</span>, <a class="code" href="xml-expat-lite_8c.html#a10">as</a>-&gt;nareas);
00314                 printf(<span class="stringliteral">"nSubnets: %d \n"</span>, <a class="code" href="xml-expat-lite_8c.html#a10">as</a>-&gt;nsubnets);
00315 
00316                 <span class="keywordflow">for</span> (<a class="code" href="xml-expat-lite_8c.html#a8">ar</a> = NULL; NULL != (<a class="code" href="xml-expat-lite_8c.html#a8">ar</a> = <a class="code" href="rn-area_8c.html#a1">rn_nextarea_onas</a>(<a class="code" href="xml-expat-lite_8c.html#a8">ar</a>, <a class="code" href="xml-expat-lite_8c.html#a10">as</a>));)
00317                 {
00318                         printf(<span class="stringliteral">"Area: %d \n"</span>, <a class="code" href="xml-expat-lite_8c.html#a8">ar</a>-&gt;id);
00319                         printf(<span class="stringliteral">"nGateways: %d \n"</span>, <a class="code" href="xml-expat-lite_8c.html#a8">ar</a>-&gt;ngateways);
00320                         printf(<span class="stringliteral">"nSubnets: %d \n"</span>, <a class="code" href="xml-expat-lite_8c.html#a8">ar</a>-&gt;nsubnets);
00321 
00322                         <span class="keywordflow">for</span> (<a class="code" href="xml-expat-lite_8c.html#a6">sn</a> = NULL; NULL != (<a class="code" href="xml-expat-lite_8c.html#a6">sn</a> = <a class="code" href="rn-subnet_8c.html#a0">rn_nextsn_onarea</a>(<a class="code" href="xml-expat-lite_8c.html#a6">sn</a>, <a class="code" href="xml-expat-lite_8c.html#a8">ar</a>));)
00323                         {
00324                                 printf(<span class="stringliteral">"Subnet: %d \n"</span>, <a class="code" href="xml-expat-lite_8c.html#a6">sn</a>-&gt;id);
00325                                 printf(<span class="stringliteral">"nRouters: %d \n"</span>, <a class="code" href="xml-expat-lite_8c.html#a6">sn</a>-&gt;nrouters);
00326                                 printf(<span class="stringliteral">"nHosts: %d \n"</span>, <a class="code" href="xml-expat-lite_8c.html#a6">sn</a>-&gt;nhosts);
00327 
00328                                 <span class="keywordflow">for</span> (<a class="code" href="xml-expat-lite_8c.html#a4">m</a> = NULL; NULL != (<a class="code" href="xml-expat-lite_8c.html#a4">m</a> = rn_nexthost_onsn(<a class="code" href="xml-expat-lite_8c.html#a4">m</a>, <a class="code" href="xml-expat-lite_8c.html#a6">sn</a>));)
00329                                 {
00330                                         g_rn_machines[<a class="code" href="xml-expat-lite_8c.html#a4">m</a>-&gt;id] = <a class="code" href="xml-expat-lite_8c.html#a4">m</a>;
00331 
00332                                         printf(<span class="stringliteral">"\tHost: %d\n"</span>, <a class="code" href="xml-expat-lite_8c.html#a4">m</a>-&gt;id);
00333                                         <a class="code" href="rn-machine_8c.html#a5">rn_machine_print</a>(<a class="code" href="xml-expat-lite_8c.html#a4">m</a>);
00334                                 }
00335 
00336                                 <span class="keywordflow">for</span> (<a class="code" href="xml-expat-lite_8c.html#a4">m</a> = NULL; 
00337                                         NULL != (<a class="code" href="xml-expat-lite_8c.html#a4">m</a> = rn_nextrouter_onsn(<a class="code" href="xml-expat-lite_8c.html#a4">m</a>, <a class="code" href="xml-expat-lite_8c.html#a6">sn</a>));)
00338                                 {
00339                                         g_rn_machines[<a class="code" href="xml-expat-lite_8c.html#a4">m</a>-&gt;id] = <a class="code" href="xml-expat-lite_8c.html#a4">m</a>;
00340 
00341                                         printf(<span class="stringliteral">"\tRouter: %d\n"</span>, <a class="code" href="xml-expat-lite_8c.html#a4">m</a>-&gt;id);
00342                                         <a class="code" href="rn-machine_8c.html#a5">rn_machine_print</a>(<a class="code" href="xml-expat-lite_8c.html#a4">m</a>);
00343                                 }
00344                         }
00345                 }
00346         }
00347 }
</pre></div><hr><address style="align: right;"><small>Generated on Tue Apr 12 17:46:14 2005 for ROSS.Net by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.18 </small></address>
</body>
</html>
